sudo yabai --load-sa
yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"


yabai -m config                         \
    external_bar            all:0:40    \
    debug_output            off         \
    layout                  bsp         \
    mouse_follows_focus     off         \
    focus_follows_mouse     off         \
    menubar_opacity         1.0         \
    window_gap              5           \
    window_shadow           float       \
    auto_balance            off         \
    split_ration            0.8         \
    window_opacity          on          \
    top_padding             10           \
    bottom_padding          10           \
    left_padding            10           \
    right_padding           10           \
    active_window_opacity   1.0         \
    normal_window_opacity   1.0

function setup_space {
  local idx="$1"
  local name="$2"
  local monitor="$3"
  local float="$4"
  local space=$(yabai -m query --spaces --space "$idx")
  if [ -z "$space" ]; then
    yabai -m space --create "$monitor"
  fi
  yabai -m space "$idx" --label "$name"
  if [ "$float" == "true" ]; then
    yabai -m space "$idx" --layout float
  fi
}

# https://github.com/koekeishiya/yabai/issues/1819
# apps='^(KezboardSwitcher)$'
# yabai -m rule --add app="JetBrains Toolbox" manage=off
yabai -m rule --add app="Kezboard Switcher" manage=off
# yabai -m signal --add event=window_created app="${apps}" action='~/.config/yabai/scripts/jetbrains'

#yabai -m signal --add app='^Ghostty$' event=window_created action='yabai -m space --layout bsp'
#yabai -m signal --add app='^Ghostty$' event=window_destroyed action='yabai -m space --layout bsp'

function setup_yabai {
  local monitor=$(yabai -m query --displays --display 2)
  setup_space 1 other 1
  setup_space 2 term 1
  setup_space 3 web 1
  setup_space 4 intellij 1

  if [ -n "$monitor" ]; then
    setup_space 5 other 2
    setup_space 6 term 2
    setup_space 7 web 2
    setup_space 8 intellij 2
  fi
}

setup_yabai

# setup borders

borders active_color=0xffff5733 inactive_color=0xffffe400 width=5.0 style=square hidpi=true&
